#!/usr/bin/env bash
# Simple Omarchy-style web app wrapper

read -p "App name: " NAME
read -p "App URL: " URL
read -p "Icon URL or path (optional): " ICON

APP_ID=$(echo "$NAME" | tr ' ' '-' | tr '[:upper:]' '[:lower:]')
DESKTOP_FILE="$HOME/.local/share/applications/webapps/${APP_ID}.desktop"
ICON_FILE="$HOME/.local/share/icons/${APP_ID}.png"

# If icon looks like a URL, try to fetch it
if [[ "$ICON" =~ ^https?:// ]]; then
  curl -L "$ICON" -o "$ICON_FILE" 2>/dev/null || ICON_FILE=""
elif [[ -f "$ICON" ]]; then
  cp "$ICON" "$ICON_FILE"
else
  ICON_FILE=""
fi

cat > "$DESKTOP_FILE" <<EOF
[Desktop Entry]
Name=$NAME
Exec=chromium --app=$URL --class=WebApp-$APP_ID
Icon=${ICON_FILE:-web-browser}
Type=Application
Categories=Network;
StartupNotify=true
EOF

echo "Created web app launcher at: $DESKTOP_FILE"

